/*
  * Copyright (c) 2016 MediaTek Inc.  All rights reserved.
  *
  * This software is available to you under a choice of one of two
  * licenses.  You may choose to be licensed under the terms of the GNU
  * General Public License (GPL) Version 2, available from the file
  * COPYING in the main directory of this source tree, or the
  * BSD license below:
  *
  *	Redistribution and use in source and binary forms, with or
  *	without modification, are permitted provided that the following
  *	conditions are met:
  *
  *	 - Redistributions of source code must retain the above
  *	   copyright notice, this list of conditions and the following
  *	   disclaimer.
  *
  *	 - Redistributions in binary form must reproduce the above
  *	   copyright notice, this list of conditions and the following
  *	   disclaimer in the documentation and/or other materials
  *	   provided with the distribution.
  *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  * SOFTWARE.
  */


#ifndef _DOT11_BASE_H_
#define _DOT11_BASE_H_

#include "rtmp_type.h"

/* value domain of 802.11 header FC.Tyte, which is b3..b2 of the 1st-byte of MAC header */
#define FC_TYPE_MGMT	0
#define FC_TYPE_CNTL	1
#define FC_TYPE_DATA	2
#define FC_TYPE_RSVED	3

/* value domain of 802.11 MGMT frame's FC.subtype, which is b7..4 of the 1st-byte of MAC header */
#define SUBTYPE_ASSOC_REQ	    0
#define SUBTYPE_ASSOC_RSP	    1
#define SUBTYPE_REASSOC_REQ	    2
#define SUBTYPE_REASSOC_RSP	    3
#define SUBTYPE_PROBE_REQ	    4
#define SUBTYPE_PROBE_RSP	    5
#define SUBTYPE_TIMING_ADV		6
#define SUBTYPE_BEACON		    8
#define SUBTYPE_ATIM		    9
#define SUBTYPE_DISASSOC	    10
#define SUBTYPE_AUTH		    11
#define SUBTYPE_DEAUTH		    12
#define SUBTYPE_ACTION		    13
#define SUBTYPE_ACTION_NO_ACK		   14

/* value domain of 802.11 CNTL frame's FC.subtype, which is b7..4 of the 1st-byte of MAC header */
#define SUBTYPE_VHT_NDPA		5
#define SUBTYPE_WRAPPER		7
#define SUBTYPE_BLOCK_ACK_REQ	    8
#define SUBTYPE_BLOCK_ACK	    9
#define SUBTYPE_PS_POLL		    10
#define SUBTYPE_RTS		    11
#define SUBTYPE_CTS		    12
#define SUBTYPE_ACK		    13
#define SUBTYPE_CFEND		    14
#define SUBTYPE_CFEND_CFACK	    15

/* value domain of 802.11 DATA frame's FC.subtype, which is b7..4 of the 1st-byte of MAC header */
#define SUBTYPE_DATA		    0
#define SUBTYPE_DATA_CFACK	    1
#define SUBTYPE_DATA_CFPOLL	    2
#define SUBTYPE_DATA_CFACK_CFPOLL   3
#define SUBTYPE_DATA_NULL	    4
#define SUBTYPE_CFACK		    5
#define SUBTYPE_CFPOLL		    6
#define SUBTYPE_CFACK_CFPOLL	    7
#define SUBTYPE_QDATA		    8
#define SUBTYPE_QDATA_CFACK	    9
#define SUBTYPE_QDATA_CFPOLL	    10
#define SUBTYPE_QDATA_CFACK_CFPOLL  11
#define SUBTYPE_QOS_NULL	    12
#define SUBTYPE_QOS_CFACK	    13
#define SUBTYPE_QOS_CFPOLL	    14
#define SUBTYPE_QOS_CFACK_CFPOLL    15

/* 2-byte Frame control field */
typedef struct GNU_PACKED {
#ifdef RT_BIG_ENDIAN
	UINT16 Order:1;		/* Strict order expected */
	UINT16 Wep:1;		/* Wep data */
	UINT16 MoreData:1;	/* More data bit */
	UINT16 PwrMgmt:1;	/* Power management bit */
	UINT16 Retry:1;		/* Retry status bit */
	UINT16 MoreFrag:1;	/* More fragment bit */
	UINT16 FrDs:1;		/* From DS indication */
	UINT16 ToDs:1;		/* To DS indication */
	UINT16 SubType:4;	/* MSDU subtype */
	UINT16 Type:2;		/* MSDU type */
	UINT16 Ver:2;		/* Protocol version */
#else
	UINT16 Ver:2;		/* Protocol version */
	UINT16 Type:2;		/* MSDU type, refer to FC_TYPE_XX */
	UINT16 SubType:4;	/* MSDU subtype, refer to  SUBTYPE_XXX */
	UINT16 ToDs:1;		/* To DS indication */
	UINT16 FrDs:1;		/* From DS indication */
	UINT16 MoreFrag:1;	/* More fragment bit */
	UINT16 Retry:1;		/* Retry status bit */
	UINT16 PwrMgmt:1;	/* Power management bit */
	UINT16 MoreData:1;	/* More data bit */
	UINT16 Wep:1;		/* Wep data */
	UINT16 Order:1;		/* Strict order expected */
#endif				/* !RT_BIG_ENDIAN */
} FRAME_CONTROL, *PFRAME_CONTROL;

typedef struct GNU_PACKED _HEADER_802_11 {
	FRAME_CONTROL FC;
	UINT16 Duration;
	UCHAR Addr1[6];
	UCHAR Addr2[6];
	UCHAR Addr3[6];
#ifdef RT_BIG_ENDIAN
	UINT16 Sequence:12;
	UINT16 Frag:4;
#else
	UINT16 Frag:4;
	UINT16 Sequence:12;
#endif				/* !RT_BIG_ENDIAN */
	UCHAR Octet[0];
} HEADER_802_11, *PHEADER_802_11;

#endif /* _DOT11_BASE_H_ */
